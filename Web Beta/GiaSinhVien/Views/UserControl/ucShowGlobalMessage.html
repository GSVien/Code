<div class="uc-show-global-message">
    <div class="list">
        <div class="list-item" ng-repeat="x in listMessage">
            <div class="message" ng-if="x.type == 'message'">
                <a href="#" class="user" ng-class="{'vip-text': x.user.vipColor}" style="{{x.user.vipColor ?'color: '+x.user.vipColor: ''}}" ud-role="user-popup" user-id="{{x.user.id}}" user-name="{{x.user.name}}" schedule-id="{{scheduleId}}" vip-id="{{x.user.vipId}}" ng-if="x.user.id">
                    <img class="vip" ng-src="{{x.user.vipPhoto}}" ng-if="x.user.vipId && x.user.vipPhoto" />
                    <img class="vip" ng-src="{{x.user.guildPhoto}}" ng-if="x.user.guildPhoto" />
                    <img class="badge" ng-src="{{x.user.badgePhoto}}" uib-tooltip="{{x.user.badgeName}}" ng-if="x.user.badgeName && x.user.badgePhoto" />
                    <div class="name">{{x.user.name + (!x.target.id ? ":" : "")}}</div>
                </a>

                <i class="fa fa-caret-right" ng-if="x.user.id && x.target.id"></i>

                <a href="#" class="user" ng-class="{'vip-text': x.target.vipColor}" style="{{x.target.vipColor ?'color: '+x.target.vipColor: ''}}" ud-role="user-popup" user-id="{{x.target.id}}" user-name="{{x.target.name}}" schedule-id="{{scheduleId}}" ng-if="x.target.id">
                    <img class="vip" ng-src="{{x.target.vipPhoto}}" ng-if="x.target.vipId && x.target.vipPhoto"/>
                    <img class="vip" ng-src="{{x.target.guildPhoto}}" ng-if="x.target.guildPhoto" />
                    <img class="badge" ng-src="{{x.target.badgePhoto}}" uib-tooltip="{{x.target.badgeName}}" ng-if="x.target.badgeName && x.target.badgePhoto" />
                    <div class="name">{{x.target.name}}:</div>
                </a>

                <span class="message" ng-class="{'vip-text': x.user.vipColor}" style="{{x.user.vipColor ?'color: '+x.user.vipColor: ''}}" compile="x.message"></span>
            </div>

            <div class="alert" ng-if="x.type == 'alert'">
                <span class="message" compile="x.message"></span>
            </div>
        </div>
    </div>

    <!--<div class="water-mark"></div>-->

    <div class="toolbar">
        <ui-select class="message-target" ng-model="messageTarget.selected">
            <ui-select-match>
                <div class="message-target-item">
                    <img-scale class="avatar" link="{{$select.selected.avatar}}" ng-if="$select.selected.avatar"></img-scale>
                    <div class="name">{{$select.selected.name}}</div>
                </div>
            </ui-select-match>
            <ui-select-choices repeat="x in (messageTarget.list) track by x.id">
                <div class="message-target-item">
                    <img-scale class="avatar" link="{{x.avatar}}" ng-if="x.avatar"></img-scale>
                    <div class="name">{{x.name}}</div>
                </div>
            </ui-select-choices>
        </ui-select>

        <button class="auto-scroll btn btn-default" ng-model="autoScroll" uib-btn-checkbox uib-tooltip="Tự động cuộn: {{autoScroll ? 'Bật' : 'Tắt'}}">
            <i class="fa fa-long-arrow-down"></i>
        </button>
    </div>

    <form ng-submit="onSendMessage($event)">
        <div class="message-panel">
            <textarea id="message-text" class="message-text" ng-keypress="onTextKeyPress($event)"></textarea>

            <button type="button" class="message-emoticon btn btn-default" ud-role="message-emoticon" emoticon-target=".uc-show-global-message .message-text">
                <i class="fa fa-smile-o"></i>
            </button>
            <input type="checkbox" id="squaredOne" class="btn btn-danger btn-message-ruby">
            <label for="squaredOne"  data-toggle="tooltip" data-placement="top" data-original-title="Chat tên lửa ({{CoinChatValue}} Ruby)"></label>
        </div>
        <button type="submit" class="btn btn-primary">Gửi</button>
    </form>
</div>